<!DOCTYPE html>
<html>
<head>
    <title>KJV Verse of the Day</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        #page-title {
            font-size: 72px;
            font-family: "Arial", sans-serif;
            font-weight: bold;
            text-align: center;
            margin-bottom: 20px;
        }

        .centered-content {
            text-align: center;
        }

        #verse-text {
            font-size: 36px;
            font-family: "Cavolini", sans-serif;
            margin-bottom: 36px;
            max-width: 1000px;
            margin-bottom: 20px;
            word-wrap: break-word;
        }

        #citation {
            font-size: 36px; /* You can adjust the font size for the citation */
            font-family: "Cavolini", sans-serif; /* You can use a different font for the citation */
        }

        .button-container {
            display: flex;
            flex-direction: column; /* Stack buttons vertically */
            gap: 20px;
            margin-top: 20px; /* Add margin to separate the buttons from the verse */
            justify-content: center; /* Center buttons horizontally */
            align-items: center; /* Center buttons vertically */
        }

        .button-container button {
            font-size: 20px;
            padding: 10px 20px;
        }
    </style>
</head>
<body>
    <h1 id="page-title">KJV Verse of the Day</h1>
    <div class="centered-content">
        <div id="verse-text">Loading...</div>
        <div id="citation"></div> <!-- Add a div for the citation -->
        <div class="button-container">
            <button id="read-chapter-button" disabled>Read Chapter</button>
            <button id="show-another-verse-button">Show Another Verse</button>
        </div>
    </div>

    <script>
        let dayOfYear;
        let verses = [];
        let dailyVerseElement;

        function getChapterURL(book, chapter) {
            const formattedBook = book.replace(/ /g, '-');
            return `https://www.kingjamesbibleonline.org/${formattedBook}-Chapter-${chapter}/`;
        }

        function displayRandomVerse() {
            const randomVerseIndex = Math.floor(Math.random() * verses.length);
            const randomVerse = verses[randomVerseIndex];
            const verseTextElement = document.getElementById("verse-text");
            const citationElement = document.getElementById("citation");

            verseTextElement.innerHTML = randomVerse.text;
            citationElement.innerHTML = randomVerse.citation;

            dailyVerseElement = randomVerse;
            const readChapterButton = document.getElementById("read-chapter-button");
            readChapterButton.removeAttribute("disabled");
        }

        document.addEventListener("DOMContentLoaded", function () {
            const verseDataUrl = 'bible_verses.csv';
            const verseTextElement = document.getElementById("verse-text");
            const citationElement = document.getElementById("citation");
            const readChapterButton = document.getElementById("read-chapter-button");
            const showAnotherVerseButton = document.getElementById("show-another-verse-button");

            fetch(verseDataUrl)
                .then(response => response.text())
                .then(data => {
                    const lines = data.split('\n');

                    for (let i = 1; i < lines.length; i++) {
                        const [citation, book, chapter, verse, text] = lines[i].split('|');
                        verses.push({ citation, book, chapter, verse, text });
                    }

                    const currentDate = new Date();
                    dayOfYear = Math.floor((currentDate - new Date(currentDate.getFullYear(), 0, 0)) / 86400000);

                    getDailyVerse();
                })
                .catch(error => {
                    console.error('Error fetching .csv file:', error);
                });

            function getDailyVerse() {
                const dailyVerseIndex = dayOfYear % verses.length;
                const dailyVerse = verses[dailyVerseIndex];

                verseTextElement.innerHTML = dailyVerse.text;
                citationElement.innerHTML = dailyVerse.citation;
                dailyVerseElement = dailyVerse;
                readChapterButton.removeAttribute("disabled");
            }

            showAnotherVerseButton.addEventListener("click", function () {
                displayRandomVerse();
            });

            readChapterButton.addEventListener("click", function () {
                if (dailyVerseElement) {
                    const chapterURL = getChapterURL(dailyVerseElement.book, dailyVerseElement.chapter);
                    window.open(chapterURL, "_blank");
                }
            });
        });
    </script>
</body>
</html>
